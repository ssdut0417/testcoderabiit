# C# Code Issues Demo

这是一个专门设计用来测试代码分析工具对C#代码检查能力的项目。项目包含了各种常见的代码问题，用于验证静态代码分析工具能否准确识别和报告这些问题。

## 项目结构

```
CSharpCodeIssues/
├── Program.cs                      # 主程序，包含12种基础代码问题
├── Security/
│   └── SecurityVulnerabilities.cs  # 安全漏洞演示（12种安全问题）
├── Performance/
│   └── PerformanceIssues.cs       # 性能问题演示（16种性能问题）
└── Utils/
    └── StringHelper.cs             # 字符串工具类（16种代码质量问题）

CSharpCodeIssues.Tests/
└── StringHelperTests.cs           # 单元测试（12种测试代码问题）
```

## 包含的代码问题类型

### 1. 主程序 (Program.cs) - 12种问题
- 硬编码的敏感信息（数据库连接字符串、API密钥）
- 未使用的字段
- 可变的静态集合（线程安全问题）
- 空引用异常风险
- 资源泄漏问题
- 安全漏洞
- 性能问题
- 并发问题
- 非线程安全的静态变量
- 未处理的异步操作
- 内存泄漏风险
- 错误的异常处理

### 2. 安全问题 (SecurityVulnerabilities.cs) - 12种问题
- SQL注入漏洞
- 命令注入漏洞
- 路径遍历漏洞
- 弱密码验证
- 不安全的随机数生成
- 不安全的加密实现（MD5）
- 不当的输入验证
- 不安全的反序列化
- 信息泄露
- 不安全的正则表达式（ReDoS攻击）
- 硬编码的URL和配置
- 敏感信息保护不当

### 3. 性能问题 (PerformanceIssues.cs) - 16种问题
- 静态缓存内存泄漏
- 低效的字符串拼接
- 不必要的对象创建
- 低效的集合操作
- 低效的正则表达式使用
- 异常控制流程
- 无限制的缓存
- 低效的排序算法（冒泡排序）
- 不必要的装箱/拆箱操作
- 低效的文件I/O操作
- 不必要的同步操作
- 低效的查找算法
- 重复计算
- 不合适的数据结构选择
- 异步操作的阻塞调用
- 内存分配过多

### 4. 字符串工具类 (StringHelper.cs) - 16种问题
- 硬编码的配置值
- 可变的静态字段
- 不安全的字符串比较（时序攻击）
- 潜在的空引用异常
- 低效的字符串操作
- 正则表达式编译问题
- 不当的异常处理
- 线程安全问题
- 内存浪费
- 硬编码的业务逻辑
- 不安全的哈希实现
- 文化敏感的字符串操作
- 潜在的无限循环
- 数据验证不足
- 编码问题
- 资源管理问题

### 5. 单元测试 (StringHelperTests.cs) - 12种问题
- 硬编码的测试数据
- 没有测试边界情况
- 测试中包含控制台输出
- 依赖于时间的不稳定测试
- 复杂的测试方法
- 测试中创建临时文件但不清理
- 忽略异常的测试
- 测试中使用Thread.Sleep
- 重复的测试逻辑
- 空的测试方法
- 测试方法名不够描述性
- 测试中包含业务逻辑

## 运行项目

### 前置要求
- .NET 6.0 SDK 或更高版本

### 编译项目
```bash
dotnet build
```

### 运行程序
```bash
dotnet run --project CSharpCodeIssues
```

### 运行测试
```bash
dotnet test
```

## 预期结果

1. **编译警告**: 项目应该能够编译成功，但会产生多个编译器警告
2. **运行时异常**: 运行时可能会遇到一些异常（这是故意设计的）
3. **测试失败**: 部分单元测试可能会失败或表现不稳定

## 代码分析工具测试

这个项目设计用来测试各种C#代码分析工具的检测能力，包括但不限于：

- **SonarQube/SonarCloud**
- **Roslyn Analyzers**
- **CodeRabiit** (目标测试工具)
- **Resharper**
- **Visual Studio Code Analysis**
- **PVS-Studio**

## 使用说明

1. 将此项目导入到你的代码分析工具中
2. 运行静态代码分析
3. 检查工具是否能识别出上述列出的各种代码问题
4. 评估工具的检测准确性和覆盖范围

## 注意事项

⚠️ **警告**: 此项目包含故意设计的安全漏洞和代码问题，仅用于测试目的。请勿在生产环境中使用这些代码模式。

## 许可证

此项目仅用于测试和教育目的。 